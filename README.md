# Bulk Video Splitter By Plan

A command-line tool to split a single video file into multiple smaller fragments based on a plan defined in a CSV file. This is particularly useful for splitting long training videos into individual exercises or segments. It also includes a command to tag video files with metadata titles based on their filenames.

## Prerequisites
- [ffmpeg](https://ffmpeg.org/download.html) (must be installed and available in your system's PATH)
- [Go](https://golang.org/doc/install) (for building or running from source)

## Installation

You can run the tool directly from source using `go run` or build a binary.

To build the application, run the following command in the project directory:

```bash
go build
```

This will create an executable file named `video-splitter` (or `video-splitter.exe` on Windows).

## Commands

The application uses a command-based interface. The two main commands are `split` and `tag`.

### Split Command

The `split` command extracts video fragments based on a plan file. It uses `ffmpeg` to create new video files for each specified time range.

#### Usage

```bash
# Using go run
go run main.go split --video="/path/to/your/video.mp4" --plan="/path/to/your/plan.csv"

# Using the built executable
./video-splitter split --video="/path/to/your/video.mp4" --plan="/path/to/your/plan.csv"
```

#### Arguments

- `--video` (`-v`): The full path to the source video file.
- `--plan` (`-p`): The full path to the plan CSV file.

#### `plan.csv` Format

The `plan.csv` file defines how the video should be split. It must contain a header and use the `|` character as a delimiter.

- **Header**: The file must start with the header line: `exercise|timestamp`
- **Columns**:
    1.  `exercise`: The name of the exercise or segment. This will be used to name the output file.
    2.  `timestamp`: The start and end times for the fragment, separated by a hyphen (`-`).
- **Timestamp Format**: Timestamps can be in `minutes:seconds` (`MM:SS`) or `hours:minutes:seconds` (`HH:MM:SS`) format.

##### Example `plan.csv`

```csv
exercise|timestamp
forehand|1:20-5:50
backhand|7:00-11:15
serve|1:05:10-1:07:55
```

### Tag Command

The `tag` command recursively finds and adds a `title` metadata tag to all `.mp4` files in a specified directory and its subdirectories. The title is derived from the filename, and the command modifies the files in-place.

#### Title Generation

The title is generated by:
1. Removing the `.mp4` file extension.
2. Removing any numerical prefix (e.g., `01_`, `02 - `).

For example:
- `01_backhand.mp4` becomes `backhand`.
- `backhand.mp4` becomes `backhand`.

#### Usage

```bash
# Using go run
go run main.go tag --dir="/path/to/your/videos"

# Using the built executable
./video-splitter tag --dir="/path/to/your/videos"
```

#### Arguments

- `--dir`: The path to the directory containing the `.mp4` files you want to tag.
